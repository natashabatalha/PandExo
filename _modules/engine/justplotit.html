<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>engine.justplotit &mdash; PandExo  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PandExo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../includeme.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Pre-installation Data Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#installation-with-pip-or-git">Installation with Pip or Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#final-test-for-success">Final Test for Success</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#troubleshooting-common-errors">Troubleshooting-Common Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#the-importance-of-upgrading-pandexo">The Importance of Upgrading PandExo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation_windows.html">Windows Installing Guide for PandExo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorialjwst.html">JWST Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jwstinput.html">Possible Instrument Input Params</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jwstdict.html">Py Dict Structure of JWST Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorialhst.html">HST Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../engine.html">The Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PandExo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">engine.justplotit</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for engine.justplotit</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span> <span class="k">as</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_file</span> <span class="k">as</span> <span class="n">outputfile</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_notebook</span>  <span class="k">as</span> <span class="n">outnotebook</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pk</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">row</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<div class="viewcode-block" id="jwst_1d_spec">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_1d_spec">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_1d_spec</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Model + Data + Error Bars&#39;</span><span class="p">,</span> <span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;data.html&#39;</span><span class="p">,</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="n">num_tran</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">y_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">output_notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots 1d simulated spectrum and rebin or rescale for more transits</span>

<span class="sd">    Plots 1d data points with model in the background (if wanted). Designed to read in exact</span>
<span class="sd">    output of run_pandexo.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict or list of dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>
<span class="sd">    model : bool</span>
<span class="sd">        (Optional) True is default. True plots model, False does not plot model</span>
<span class="sd">    title : str</span>
<span class="sd">        (Optional) Title of plot. Default is &quot;Model + Data + Error Bars&quot;.</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) name of html file for you bokeh plot. After bokeh plot is rendered you will</span>
<span class="sd">        have the option to save as png.</span>
<span class="sd">    legend : bool</span>
<span class="sd">        (Optional) Default is False. True, plots legend.</span>
<span class="sd">    R : float</span>
<span class="sd">        (Optional) Rebin data from native instrument resolution to specified resolution. Dafult is False,</span>
<span class="sd">        no binning. Here I adopt R as w[1]/(w[2] - w[0]) to maintain consistency with `pandeia.engine`</span>
<span class="sd">    num_tran : float</span>
<span class="sd">        (Optional) Scales data by number of transits to improve error by sqrt(`num_trans`)</span>
<span class="sd">    plot_width : int</span>
<span class="sd">        (Optional) Sets the width of the plot. Default = 800</span>
<span class="sd">    plot_height : int</span>
<span class="sd">        (Optional) Sets the height of the plot. Default = 400</span>
<span class="sd">    y_range : list of int</span>
<span class="sd">        (Optional) sets y range of plot. Defaut is +- 10% of max and min</span>
<span class="sd">    x_range : list of int</span>
<span class="sd">        (Optional) Sets x range of plot. Default = [1,10]</span>
<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) Supresses the plot if not wanted (Default = True)</span>
<span class="sd">    out_notebook : bool </span>
<span class="sd">        (Optional) Output notebook. Default is false, if true, outputs in the notebook</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x,y,e : list of arrays</span>
<span class="sd">        Returns wave axis, spectrum and associated error in list format. x[0] will be correspond</span>
<span class="sd">        to the first dictionary input, x[1] to the second, etc.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; jwst_1d_spec(result_dict, num_tran = 3, R = 35) #for a single plot</span>

<span class="sd">    If you wanted to save each of the axis that were being plotted:</span>

<span class="sd">    &gt;&gt;&gt; x,y,e = jwst_1d_data([result_dict1, result_dict2], model=False, num_tran = 5, R = 100) #for multiple</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_noise, jwst_1d_bkg, jwst_1d_flux, jwst_1d_snr, jwst_2d_det, jwst_2d_sat</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">outy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">oute</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="k">if</span> <span class="n">output_notebook</span> <span class="o">&amp;</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outnotebook</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;brown&#39;</span><span class="p">]</span>
    <span class="c1">#make sure its iterable</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">result_dict</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">result_dict</span> <span class="o">=</span> <span class="p">[</span><span class="n">result_dict</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span><span class="o">!=</span><span class="nb">bool</span><span class="p">:</span>
        <span class="n">legend_keys</span> <span class="o">=</span> <span class="n">legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">legend_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">legend_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">legend_keys</span><span class="p">]</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">dictt</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="p">:</span>
        <span class="n">ntran_old</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;timing&#39;</span><span class="p">][</span><span class="s1">&#39;Number of Transits&#39;</span><span class="p">]</span>
        <span class="n">to</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;timing&#39;</span><span class="p">][</span><span class="s2">&quot;Num Integrations Out of Transit&quot;</span><span class="p">]</span>
        <span class="n">ti</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;timing&#39;</span><span class="p">][</span><span class="s2">&quot;Num Integrations In Transit&quot;</span><span class="p">]</span>
        <span class="c1">#remove any nans</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;FinalSpectrum&#39;</span><span class="p">][</span><span class="s1">&#39;spectrum_w_rand&#39;</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;FinalSpectrum&#39;</span><span class="p">][</span><span class="s1">&#39;wave&#39;</span><span class="p">][</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;FinalSpectrum&#39;</span><span class="p">][</span><span class="s1">&#39;error_w_floor&#39;</span><span class="p">][</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>


        <span class="k">if</span> <span class="p">(</span><span class="n">R</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">num_tran</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">R</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">num_tran</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">new_wave</span> <span class="o">=</span> <span class="n">bin_wave_to_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_out&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span><span class="p">)</span>
            <span class="n">inn</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_in&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span><span class="p">)</span>
            <span class="n">vout</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_out&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span><span class="p">)</span>
            <span class="n">vin</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_in&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span><span class="p">)</span>
            <span class="n">var_tot</span> <span class="o">=</span> <span class="p">(</span><span class="n">to</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span><span class="n">out</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vin</span> <span class="o">+</span> <span class="p">(</span><span class="n">inn</span><span class="o">*</span><span class="n">to</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span><span class="n">out</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vout</span>
            <span class="k">if</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Primary/Secondary&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;fp/f*&#39;</span><span class="p">:</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">rand_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">var_tot</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_wave</span><span class="p">)))</span>
            <span class="n">raw_spec</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="o">/</span><span class="n">to</span><span class="o">-</span><span class="n">inn</span><span class="o">/</span><span class="n">ti</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">out</span><span class="o">/</span><span class="n">to</span><span class="p">)</span>
            <span class="n">sim_spec</span> <span class="o">=</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">raw_spec</span> <span class="o">+</span> <span class="n">rand_noise</span> <span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">new_wave</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">sim_spec</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_tot</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">R</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">num_tran</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_out&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span>
            <span class="n">inn</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_in&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span>
            <span class="n">vout</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_out&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span>
            <span class="n">vin</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_in&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">num_tran</span><span class="o">/</span><span class="n">ntran_old</span>
            <span class="n">var_tot</span> <span class="o">=</span> <span class="p">(</span><span class="n">to</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span><span class="n">out</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vin</span> <span class="o">+</span> <span class="p">(</span><span class="n">inn</span><span class="o">*</span><span class="n">to</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span><span class="n">out</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vout</span>
            <span class="k">if</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Primary/Secondary&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;fp/f*&#39;</span><span class="p">:</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">rand_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">var_tot</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="n">raw_spec</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="o">/</span><span class="n">to</span><span class="o">-</span><span class="n">inn</span><span class="o">/</span><span class="n">ti</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">out</span><span class="o">/</span><span class="n">to</span><span class="p">)</span>
            <span class="n">sim_spec</span> <span class="o">=</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">raw_spec</span> <span class="o">+</span> <span class="n">rand_noise</span> <span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">sim_spec</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_tot</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">R</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">num_tran</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">new_wave</span> <span class="o">=</span> <span class="n">bin_wave_to_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_out&#39;</span><span class="p">])</span>
            <span class="n">inn</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_in&#39;</span><span class="p">])</span>
            <span class="n">vout</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_out&#39;</span><span class="p">])</span>
            <span class="n">vin</span> <span class="o">=</span> <span class="n">uniform_tophat_sum</span><span class="p">(</span><span class="n">new_wave</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_in&#39;</span><span class="p">])</span>
            <span class="n">var_tot</span> <span class="o">=</span> <span class="p">(</span><span class="n">to</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span><span class="n">out</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vin</span> <span class="o">+</span> <span class="p">(</span><span class="n">inn</span><span class="o">*</span><span class="n">to</span><span class="o">/</span><span class="n">ti</span><span class="o">/</span><span class="n">out</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vout</span>
            <span class="k">if</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Primary/Secondary&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;fp/f*&#39;</span><span class="p">:</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">rand_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">var_tot</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_wave</span><span class="p">)))</span>
            <span class="n">raw_spec</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="o">/</span><span class="n">to</span><span class="o">-</span><span class="n">inn</span><span class="o">/</span><span class="n">ti</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">out</span><span class="o">/</span><span class="n">to</span><span class="p">)</span>
            <span class="n">sim_spec</span> <span class="o">=</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">raw_spec</span> <span class="o">+</span> <span class="n">rand_noise</span> <span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">new_wave</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">sim_spec</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_tot</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something went wrong. Cannot enter both resolution and ask to bin to new wave&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">err</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        
        <span class="c1">#create error bars for Bokeh&#39;s multi_line and drop nans</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;err&#39;</span><span class="p">:</span><span class="n">err</span><span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="n">y_err</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x_err</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">yerr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_err</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">px</span><span class="p">)))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_err</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">py</span> <span class="o">-</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">py</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">)))</span>
        <span class="c1">#initialize Figure</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#Define units for x and y axis</span>
            <span class="n">y_axis_label</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Primary/Secondary&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">y_axis_label</span> <span class="o">==</span> <span class="s1">&#39;fp/f*&#39;</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">y_axis_label</span> <span class="o">=</span> <span class="n">y_axis_label</span>

            <span class="k">if</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Calculation Type&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;phase_spec&#39;</span><span class="p">:</span>
                <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Time (secs)&#39;</span>
                <span class="n">x_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength [microns]&#39;</span>

            <span class="k">if</span> <span class="n">y_range</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
                <span class="n">ylims</span> <span class="o">=</span> <span class="n">y_range</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ylims</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;OriginalInput&#39;</span><span class="p">][</span><span class="s1">&#39;model_spec&#39;</span><span class="p">])</span><span class="o">-</span> <span class="mf">0.1</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;OriginalInput&#39;</span><span class="p">][</span><span class="s1">&#39;model_spec&#39;</span><span class="p">]),</span>
                 <span class="mf">0.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;OriginalInput&#39;</span><span class="p">][</span><span class="s1">&#39;model_spec&#39;</span><span class="p">])</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;OriginalInput&#39;</span><span class="p">][</span><span class="s1">&#39;model_spec&#39;</span><span class="p">])]</span>

            <span class="n">fig1d</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span> <span class="o">=</span> <span class="n">ylims</span><span class="p">,</span>
               <span class="n">width</span> <span class="o">=</span> <span class="n">plot_width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="n">plot_height</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">x_axis_label</span><span class="o">=</span><span class="n">x_axis_label</span><span class="p">,</span>
              <span class="n">y_axis_label</span> <span class="o">=</span> <span class="n">y_axis_label</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span> <span class="n">background_fill_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>


        <span class="c1">#plot model, data, and errors</span>
        <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">mxx</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;OriginalInput&#39;</span><span class="p">][</span><span class="s1">&#39;model_wave&#39;</span><span class="p">]</span>
            <span class="n">myy</span> <span class="o">=</span> <span class="n">dictt</span><span class="p">[</span><span class="s1">&#39;OriginalInput&#39;</span><span class="p">][</span><span class="s1">&#39;model_spec&#39;</span><span class="p">]</span>
            <span class="n">my</span> <span class="o">=</span> <span class="n">uniform_tophat_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mxx</span><span class="p">,</span><span class="n">myy</span><span class="p">)</span>
            <span class="n">model_line</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;my&#39;</span><span class="p">:</span><span class="n">my</span><span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">fig1d</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">model_line</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">model_line</span><span class="p">[</span><span class="s1">&#39;my&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">fig1d</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">legend</span> <span class="o">=</span> <span class="n">legend_keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig1d</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">outx</span> <span class="o">+=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="n">outy</span> <span class="o">+=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="n">oute</span> <span class="o">+=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="n">fig1d</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="n">x_err</span><span class="p">,</span> <span class="n">y_err</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">show</span><span class="p">(</span><span class="n">fig1d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outx</span><span class="p">,</span><span class="n">outy</span><span class="p">,</span><span class="n">oute</span></div>



<div class="viewcode-block" id="bin_wave_to_R">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.bin_wave_to_R">[docs]</a>
<span class="k">def</span> <span class="nf">bin_wave_to_R</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates new wavelength axis at specified resolution</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    w : list of float or numpy array of float</span>
<span class="sd">        Wavelength axis to be rebinned</span>
<span class="sd">    R : float or int</span>
<span class="sd">        Resolution to bin axis to</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of float</span>
<span class="sd">        New wavelength axis at specified resolution</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; newwave = bin_wave_to_R(np.linspace(1,2,1000), 10)</span>
<span class="sd">    &gt;&gt;&gt; print(len(newwave))</span>
<span class="sd">    11</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tracker</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ind</span><span class="o">=</span> <span class="mi">0</span>
    <span class="n">firsttime</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span><span class="p">(</span><span class="n">tracker</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="n">w</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">dlambda</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">newR</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">dlambda</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">newR</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">):</span>
                <span class="n">tracker</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="n">wave</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tracker</span><span class="p">]</span>
                <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">firsttime</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">newR</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">:</span>
                <span class="n">tracker</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">+</span><span class="n">dlambda</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="n">wave</span> <span class="o">+=</span><span class="p">[</span><span class="n">tracker</span><span class="p">]</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="n">tracker</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">ind</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">firsttime</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">firsttime</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tracker</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="n">wave</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tracker</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">wave</span></div>


<div class="viewcode-block" id="uniform_tophat_sum">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.uniform_tophat_sum">[docs]</a>
<span class="k">def</span> <span class="nf">uniform_tophat_sum</span><span class="p">(</span><span class="n">xnew</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapted from Mike R. Line to rebin spectra</span>

<span class="sd">    Takes sum of group of points in bin of wave points</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xnew : list of float or numpy array of float</span>
<span class="sd">        New wavelength grid to rebin to</span>
<span class="sd">    x : list of float or numpy array of float</span>
<span class="sd">        Old wavelength grid to get rid of</span>
<span class="sd">    y : list of float or numpy array of float</span>
<span class="sd">        New rebinned y axis</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array of floats</span>
<span class="sd">        new y axis</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; oldgrid = np.linspace(1,3,100)</span>
<span class="sd">    &gt;&gt;&gt; y = np.zeros(100)+10.0</span>
<span class="sd">    &gt;&gt;&gt; newy = uniform_tophat_sum(np.linspace(2,3,3), oldgrid, y)</span>
<span class="sd">    &gt;&gt;&gt; newy</span>
<span class="sd">    array([ 240.,  250.,  130.])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span>
    <span class="n">szmod</span><span class="o">=</span><span class="n">xnew</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">delta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">szmod</span><span class="p">)</span>
    <span class="n">ynew</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">szmod</span><span class="p">)</span>
    <span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">xnew</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">xnew</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">delta</span><span class="p">[</span><span class="n">szmod</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">delta</span><span class="p">[</span><span class="n">szmod</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1">#pdb.set_trace()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">szmod</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xnew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">xnew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">ynew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">loc</span><span class="p">])</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">xnew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">xnew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">ynew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">loc</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ynew</span></div>


<div class="viewcode-block" id="uniform_tophat_mean">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.uniform_tophat_mean">[docs]</a>
<span class="k">def</span> <span class="nf">uniform_tophat_mean</span><span class="p">(</span><span class="n">xnew</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapted from Mike R. Line to rebin spectra</span>

<span class="sd">    Takes average of group of points in bin</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xnew : list of float or numpy array of float</span>
<span class="sd">        New wavelength grid to rebin to</span>
<span class="sd">    x : list of float or numpy array of float</span>
<span class="sd">        Old wavelength grid to get rid of</span>
<span class="sd">    y : list of float or numpy array of float</span>
<span class="sd">        New rebinned y axis</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array of floats</span>
<span class="sd">        new y axis</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; oldgrid = np.linspace(1,3,100)</span>
<span class="sd">    &gt;&gt;&gt; y = np.zeros(100)+10.0</span>
<span class="sd">    &gt;&gt;&gt; newy = uniform_tophat_sum(np.linspace(2,3,3), oldgrid, y)</span>
<span class="sd">    &gt;&gt;&gt; newy</span>
<span class="sd">    array([ 240.,  250.,  130.])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span>
    <span class="n">szmod</span><span class="o">=</span><span class="n">xnew</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">delta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">szmod</span><span class="p">)</span>
    <span class="n">ynew</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">szmod</span><span class="p">)</span>
    <span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">xnew</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">xnew</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">delta</span><span class="p">[</span><span class="n">szmod</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">delta</span><span class="p">[</span><span class="n">szmod</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1">#pdb.set_trace()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">szmod</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xnew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">xnew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">ynew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">loc</span><span class="p">])</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">xnew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">xnew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">ynew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">loc</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ynew</span></div>


<div class="viewcode-block" id="jwst_1d_flux">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_1d_flux">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_1d_flux</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span> <span class="s1">&#39;flux.html&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot flux rate in e/s</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>
<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, Flase does not. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;flux.html&#39;</span>
<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    x : numpy array</span>
<span class="sd">        micron</span>
<span class="sd">    y : numpy array</span>
<span class="sd">        1D flux rate in electrons/s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_1d_spec, jwst_1d_bkg, jwst_noise, jwst_1d_snr, jwst_2d_det, jwst_2d_sat</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;PandeiaOutTrans&#39;</span><span class="p">]</span>

    <span class="c1"># Flux 1d</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;1d&#39;</span><span class="p">][</span><span class="s1">&#39;extracted_flux&#39;</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>

    <span class="n">plot_flux_1d1</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span>
                         <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength [microns]&#39;</span><span class="p">,</span>
                         <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (e/s)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Out of Transit Flux Rate&quot;</span><span class="p">,</span>
                         <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">plot_flux_1d1</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.7</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_flux_1d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span></div>


<div class="viewcode-block" id="jwst_1d_snr">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_1d_snr">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_1d_snr</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;snr.html&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot SNR</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>
<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, Flase does not. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;snr.html&#39;</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    x : numpy array</span>
<span class="sd">        micron</span>
<span class="sd">    y : numpy array</span>
<span class="sd">        1D SNR</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_1d_bkg, jwst_noise, jwst_1d_flux, jwst_1d_spec, jwst_2d_det, jwst_2d_sat</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="c1"># Flux 1d</span>
    <span class="n">x</span><span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;wave&#39;</span><span class="p">]</span>
    <span class="n">electrons_out</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;electrons_out&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">electrons_out</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;RawData&#39;</span><span class="p">][</span><span class="s1">&#39;var_out&#39;</span><span class="p">])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">plot_snr_1d1</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span>
                         <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength (micron)&#39;</span><span class="p">,</span>
                         <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;SNR&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;SNR Out of Trans&quot;</span><span class="p">,</span>
                         <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">plot_snr_1d1</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_snr_1d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span></div>


<div class="viewcode-block" id="jwst_1d_bkg">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_1d_bkg">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_1d_bkg</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;bkg.html&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot background</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>
<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, Flase does not. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = bkt.html</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    x : numpy array</span>
<span class="sd">        micron</span>
<span class="sd">    y : numpy array</span>
<span class="sd">        1D bakground e/s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_1d_spec, jwst_noise, jwst_1d_flux, jwst_1d_snr, jwst_2d_det, jwst_2d_sat</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="c1"># BG 1d</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;PandeiaOutTrans&#39;</span><span class="p">]</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;1d&#39;</span><span class="p">][</span><span class="s1">&#39;extracted_bg_only&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">plot_bg_1d1</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span>
                         <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength [microns]&#39;</span><span class="p">,</span>
                         <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (e/s)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Background&quot;</span><span class="p">,</span>
                         <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">plot_bg_1d1</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_bg_1d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span></div>


<div class="viewcode-block" id="jwst_noise">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_noise">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_noise</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span> <span class="s1">&#39;noise.html&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot background</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>
<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, Flase does not. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;noise.html&#39;</span>
<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    x : numpy array</span>
<span class="sd">        micron</span>
<span class="sd">    y : numpy array</span>
<span class="sd">        1D noise (ppm)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_1d_spec, jwst_1d_bkg, jwst_1d_flux, jwst_1d_snr, jwst_2d_det, jwst_2d_sat</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>    <span class="c1">#saturation</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;FinalSpectrum&#39;</span><span class="p">][</span><span class="s1">&#39;wave&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;FinalSpectrum&#39;</span><span class="p">][</span><span class="s1">&#39;error_w_floor&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e6</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">ymed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>


    <span class="n">plot_noise_1d1</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span><span class="c1">#responsive=True,</span>
                         <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength (micron)&#39;</span><span class="p">,</span>
                         <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Error on Spectrum (PPM)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Error Curve&quot;</span><span class="p">,</span>
                         <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">y_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="n">ymed</span><span class="p">])</span>
    <span class="n">ymed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">plot_noise_1d1</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_noise_1d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span></div>


<div class="viewcode-block" id="jwst_2d_det">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_2d_det">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_2d_det</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;det2d.html&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot 2d detector image</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>

<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, Flase does not. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;det2d.html&#39;</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    numpy array</span>
<span class="sd">        2D array of out of transit detector simulation</span>
<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_1d_spec, jwst_1d_bkg, jwst_1d_flux, jwst_1d_snr, jwst_noise, jwst_2d_sat</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;PandeiaOutTrans&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;2d&#39;</span><span class="p">][</span><span class="s1">&#39;detector&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;miri&#39;</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Instrument&#39;</span><span class="p">]:</span> 
        <span class="n">width</span><span class="o">=</span><span class="mi">300</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">800</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">width</span><span class="o">=</span><span class="mi">800</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">300</span>

    <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">plot_detector_2d</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,hover,save&quot;</span><span class="p">,</span>
                         <span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">yr</span><span class="p">],</span> <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">xr</span><span class="p">],</span>
                         <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Pixel&#39;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Spatial&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="s2">&quot;2D Detector Image&quot;</span><span class="p">,</span>
                        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

    <span class="n">plot_detector_2d</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dh</span><span class="o">=</span><span class="p">[</span><span class="n">xr</span><span class="p">],</span> <span class="n">dw</span><span class="o">=</span><span class="p">[</span><span class="n">yr</span><span class="p">],</span>
                      <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Spectral11&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_detector_2d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>



<div class="viewcode-block" id="jwst_2d_sat">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.jwst_2d_sat">[docs]</a>
<span class="k">def</span> <span class="nf">jwst_2d_sat</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;sat2d.html&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot 2d saturation profile</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output. If parameter space was run in run_pandexo</span>
<span class="sd">        make sure to restructure the input as a list of dictionaries without they key words</span>
<span class="sd">        that run_pandexo assigns.</span>

<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, Flase does not. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;sat2d.html&#39;</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    numpy array</span>
<span class="sd">        2D array of out of transit detector simulation</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    jwst_1d_spec, jwst_1d_bkg, jwst_1d_flux, jwst_1d_snr, jwst_2d_det, jwst_noise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>    <span class="c1">#saturation</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;PandeiaOutTrans&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;2d&#39;</span><span class="p">][</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span>
    <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">if</span> <span class="s1">&#39;miri&#39;</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="s1">&#39;Instrument&#39;</span><span class="p">]:</span> 
        <span class="n">width</span><span class="o">=</span><span class="mi">300</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">800</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">width</span><span class="o">=</span><span class="mi">800</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">300</span>
        
    <span class="n">plot_sat_2d</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span>
                         <span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">yr</span><span class="p">],</span> <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">xr</span><span class="p">],</span>
                         <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Pixel&#39;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Spatial&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Saturation&quot;</span><span class="p">,</span>
                        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

    <span class="n">plot_sat_2d</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dh</span><span class="o">=</span><span class="p">[</span><span class="n">xr</span><span class="p">],</span> <span class="n">dw</span><span class="o">=</span><span class="p">[</span><span class="n">yr</span><span class="p">],</span>
                      <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Spectral11&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_sat_2d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="hst_spec">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.hst_spec">[docs]</a>
<span class="k">def</span> <span class="nf">hst_spec</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span> <span class="o">=</span><span class="s1">&#39;hstspec.html&#39;</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">output_notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot 1d spec with error bars for hst</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output.</span>

<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, False does not. Default=True</span>
<span class="sd">    model : bool</span>
<span class="sd">        (Optional) Plot model under data. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;hstspec.html&#39;</span>
<span class="sd">    output_notebook : bool </span>
<span class="sd">        (Optional) Default true, plots in notebook</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    x : numpy array</span>
<span class="sd">        micron</span>
<span class="sd">    y : numpy array</span>
<span class="sd">        1D spec fp/f* or rp^2/r*^2</span>
<span class="sd">    e : numpy array</span>
<span class="sd">        1D rms noise</span>
<span class="sd">    modelx : numpy array</span>
<span class="sd">        micron</span>
<span class="sd">    modely : numpy array</span>
<span class="sd">        1D spec fp/f* or rp^2/r*^2</span>
<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    hst_time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="c1">#plot planet spectrum</span>
    <span class="n">mwave</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;model_wave&#39;</span><span class="p">]</span>
    <span class="n">mspec</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;model_spec&#39;</span><span class="p">]</span>

    <span class="n">binwave</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;binwave&#39;</span><span class="p">]</span>
    <span class="n">binspec</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;binspec&#39;</span><span class="p">]</span>

    <span class="n">error</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binspec</span><span class="p">))</span><span class="o">+</span> <span class="n">error</span>
    <span class="n">xlims</span> <span class="o">=</span> <span class="p">[</span><span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;wmin&#39;</span><span class="p">],</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;planet_spec&#39;</span><span class="p">][</span><span class="s1">&#39;wmax&#39;</span><span class="p">]]</span>
    <span class="n">ylims</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">binspec</span><span class="p">)</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">binspec</span><span class="p">)</span><span class="o">+</span><span class="mf">2.0</span><span class="o">*</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="n">plot_spectrum</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span>
                               <span class="n">y_range</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span><span class="c1">#responsive=True,</span>
                                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength [microns]&#39;</span><span class="p">,</span>
                                 <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Ratio&#39;</span><span class="p">,</span>
                               <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Original Model with Observation&quot;</span><span class="p">)</span>

    <span class="n">y_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">yerr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">binwave</span><span class="p">,</span> <span class="n">binspec</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_err</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">px</span><span class="p">)))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_err</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">py</span> <span class="o">-</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">py</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
        <span class="n">plot_spectrum</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">mwave</span><span class="p">,</span><span class="n">mspec</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">plot_spectrum</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">binwave</span><span class="p">,</span><span class="n">binspec</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plot_spectrum</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="n">x_err</span><span class="p">,</span> <span class="n">y_err</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_notebook</span> <span class="o">&amp;</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outnotebook</span><span class="p">()</span>
        <span class="n">show</span><span class="p">(</span><span class="n">plot_spectrum</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        
        <span class="n">show</span><span class="p">(</span><span class="n">plot_spectrum</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">binwave</span><span class="p">,</span> <span class="n">binspec</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">mwave</span><span class="p">,</span> <span class="n">mspec</span></div>


<div class="viewcode-block" id="hst_time">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.hst_time">[docs]</a>
<span class="k">def</span> <span class="nf">hst_time</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span> <span class="o">=</span><span class="s1">&#39;hsttime.html&#39;</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">output_notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot earliest and latest start times for hst observation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output.</span>

<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, False does not. Default=True</span>
<span class="sd">    model : bool</span>
<span class="sd">        (Optional) Plot model under data. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;hsttime.html&#39;</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    obsphase1 : numpy array</span>
<span class="sd">        earliest start time</span>
<span class="sd">    obstr1 : numpy array</span>
<span class="sd">        white light curve</span>
<span class="sd">    obsphase2 : numpy array</span>
<span class="sd">        latest start time</span>
<span class="sd">    obstr2 : numpy array</span>
<span class="sd">        white light curve</span>
<span class="sd">    rms : numpy array</span>
<span class="sd">        1D rms noise</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    hst_spec</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="c1">#earliest and latest start times</span>
    <span class="n">obsphase1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;obsphase1&#39;</span><span class="p">]</span>
    <span class="n">obstr1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;obstr1&#39;</span><span class="p">]</span>
    <span class="n">rms</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;light_curve_rms&#39;</span><span class="p">]</span>
    <span class="n">obsphase2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;obsphase2&#39;</span><span class="p">]</span>
    <span class="n">obstr2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;obstr2&#39;</span><span class="p">]</span>
    <span class="n">phase1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;phase1&#39;</span><span class="p">]</span>
    <span class="n">phase2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;phase2&#39;</span><span class="p">]</span>
    <span class="n">trmodel1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;trmodel1&#39;</span><span class="p">]</span>
    <span class="n">trmodel2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;calc_start_window&#39;</span><span class="p">][</span><span class="s1">&#39;trmodel2&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rms</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obsphase1</span><span class="p">))</span><span class="o">+</span><span class="n">rms</span>
    <span class="n">y_err1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_err1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">yerr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsphase1</span><span class="p">,</span> <span class="n">obstr1</span><span class="p">,</span> <span class="n">rms</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_err1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">px</span><span class="p">)))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_err1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">py</span> <span class="o">-</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">py</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">)))</span>

    <span class="n">y_err2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_err2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">yerr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsphase2</span><span class="p">,</span> <span class="n">obstr2</span><span class="p">,</span> <span class="n">rms</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_err2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">px</span><span class="p">)))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_err2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">py</span> <span class="o">-</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">py</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">)))</span>

    <span class="n">early</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                               <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span><span class="c1">#responsive=True,</span>
                                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Orbital Phase&#39;</span><span class="p">,</span>
                                 <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux&#39;</span><span class="p">,</span>
                               <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Earliest Start Time&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span><span class="p">:</span> <span class="n">early</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">phase1</span><span class="p">,</span> <span class="n">trmodel1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">early</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">obsphase1</span><span class="p">,</span> <span class="n">obstr1</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">early</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="n">x_err1</span><span class="p">,</span> <span class="n">y_err1</span><span class="p">)</span>

    <span class="n">late</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                                <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span><span class="c1">#responsive=True,</span>
                                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Orbital Phase&#39;</span><span class="p">,</span>
                                 <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux&#39;</span><span class="p">,</span>
                               <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Latest Start Time&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">model</span><span class="p">:</span> <span class="n">late</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">phase2</span><span class="p">,</span> <span class="n">trmodel2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">line_width</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">late</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">obsphase2</span><span class="p">,</span> <span class="n">obstr2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">late</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="n">x_err2</span><span class="p">,</span> <span class="n">y_err2</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">row</span><span class="p">(</span><span class="n">early</span><span class="p">,</span> <span class="n">late</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">output_notebook</span> <span class="o">&amp;</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outnotebook</span><span class="p">()</span>
        <span class="n">show</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">obsphase1</span><span class="p">,</span> <span class="n">obstr1</span><span class="p">,</span> <span class="n">obsphase2</span><span class="p">,</span> <span class="n">obstr2</span><span class="p">,</span><span class="n">rms</span></div>



<div class="viewcode-block" id="hst_simulated_lightcurve">
<a class="viewcode-back" href="../../engine.html#engine.justplotit.hst_simulated_lightcurve">[docs]</a>
<span class="k">def</span> <span class="nf">hst_simulated_lightcurve</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span> <span class="o">=</span><span class="s1">&#39;hsttime.html&#39;</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">output_notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot simulated HST light curves (in fluece) for earliest and latest start times</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result_dict : dict</span>
<span class="sd">        Dictionary from pandexo output.</span>

<span class="sd">    plot : bool</span>
<span class="sd">        (Optional) True renders plot, False does not. Default=True</span>
<span class="sd">    model : bool</span>
<span class="sd">        (Optional) Plot model under data. Default=True</span>
<span class="sd">    output_file : str</span>
<span class="sd">        (Optional) Default = &#39;hsttime.html&#39;</span>

<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    obsphase1 : numpy array</span>
<span class="sd">        earliest start time</span>
<span class="sd">    counts1 : numpy array</span>
<span class="sd">        white light curve in fluence (e/pixel)</span>
<span class="sd">    obsphase2 : numpy array</span>
<span class="sd">        latest start time</span>
<span class="sd">    counts2 : numpy array</span>
<span class="sd">        white light curve in fluence (e/pixel)</span>
<span class="sd">    rms : numpy array</span>
<span class="sd">        1D rms noise</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    hst_spec</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="s2">&quot;pan,wheel_zoom,box_zoom,reset,save&quot;</span>
    <span class="c1"># earliest and latest start times</span>
    <span class="n">obsphase1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;obsphase1&#39;</span><span class="p">]</span>
    <span class="n">rms</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;light_curve_rms&#39;</span><span class="p">]</span>
    <span class="n">obsphase2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;obsphase2&#39;</span><span class="p">]</span>
    <span class="n">phase1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;phase1&#39;</span><span class="p">]</span>
    <span class="n">phase2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;phase2&#39;</span><span class="p">]</span>
    <span class="n">counts1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;counts1&#39;</span><span class="p">]</span>
    <span class="n">counts2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;counts2&#39;</span><span class="p">]</span>
    <span class="n">count_noise</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;count_noise&#39;</span><span class="p">]</span>
    <span class="n">ramp_included</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;ramp_included&#39;</span><span class="p">]</span>
    <span class="n">model_counts1</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;model_counts1&#39;</span><span class="p">]</span>
    <span class="n">model_counts2</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;light_curve&#39;</span><span class="p">][</span><span class="s1">&#39;model_counts2&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count_noise</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">counts1</span><span class="p">))</span> <span class="o">+</span> <span class="n">count_noise</span>
    <span class="n">y_err1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_err1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">yerr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsphase1</span><span class="p">,</span> <span class="n">counts1</span><span class="p">,</span> <span class="n">rms</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_err1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">px</span><span class="p">)))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_err1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">py</span> <span class="o">-</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">py</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">)))</span>

    <span class="n">y_err2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_err2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">yerr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsphase2</span><span class="p">,</span> <span class="n">counts2</span><span class="p">,</span> <span class="n">rms</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_err2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">px</span><span class="p">)))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_err2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">py</span> <span class="o">-</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">py</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">ramp_included</span><span class="p">:</span>
        <span class="n">title_description</span> <span class="o">=</span> <span class="s2">&quot; (Ramp Included)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">title_description</span> <span class="o">=</span><span class="s2">&quot; (Ramp Removed)&quot;</span>

    <span class="n">early</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                               <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span><span class="c1">#responsive=True,</span>
                                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Orbital Phase&#39;</span><span class="p">,</span>
                                 <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux [electrons/pixel]&#39;</span><span class="p">,</span>
                               <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Earliest Start Time&quot;</span> <span class="o">+</span> <span class="n">title_description</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
        <span class="n">early</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">phase1</span><span class="p">,</span> <span class="n">model_counts1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">early</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">obsphase1</span><span class="p">,</span> <span class="n">counts1</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">early</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="n">x_err1</span><span class="p">,</span> <span class="n">y_err1</span><span class="p">)</span>

    <span class="n">late</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                  <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">,</span>  <span class="c1"># responsive=True,</span>
                  <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Orbital Phase&#39;</span><span class="p">,</span>
                  <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux [electrons/pixel]&#39;</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Latest Start Time&quot;</span> <span class="o">+</span> <span class="n">title_description</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
        <span class="n">late</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">phase2</span><span class="p">,</span> <span class="n">model_counts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">late</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">obsphase2</span><span class="p">,</span> <span class="n">counts2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">late</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="n">x_err2</span><span class="p">,</span> <span class="n">y_err2</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">row</span><span class="p">(</span><span class="n">early</span><span class="p">,</span> <span class="n">late</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">output_notebook</span><span class="p">:</span> 
            <span class="n">outnotebook</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outputfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">obsphase1</span><span class="p">,</span> <span class="n">counts1</span><span class="p">,</span> <span class="n">obsphase2</span><span class="p">,</span> <span class="n">counts2</span><span class="p">,</span> <span class="n">rms</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Updated 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>